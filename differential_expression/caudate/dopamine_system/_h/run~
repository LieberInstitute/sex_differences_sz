#!/bin/bash

GTF="/ceph/genome/human/gencode25/gtf.CHR/_m"

echo "Starting transcript annotation for DRD2!"

grep -i drd2 $GTF/gencode.v25.annotation.gtf | grep -w exon | grep 113414461 | \
    sed 's/;/\t/g' | sed 's/"//g' | cut -f 1,3-5,7,9,10,13-14,16,18 | sed 's/ /\t/g' | \
    cut -f 1-5,7,10,13,16,19,22 > long_drd2_with_exon6.txt

grep -i drd2 $GTF/gencode.v25.annotation.gtf | grep -w transcript | sed 's/;/\t/g' | \
    sed 's/"//g' | cut -f 1,3-5,7,9-10,13-14,16 | sed 's/ /\t/g' | \
    cut -f1-5,7,10,13,16,19 > drd2_transcripts.txt

grep -vf <(cut -f10 long_drd2_with_exon6.txt) drd2_transcripts.txt > short_drd2_transcripts.txt

echo 'Exon annotation'

grep -i drd2 /ceph/projects/v3_phase3_paper/analysis/twas/_m/exons/annotations.txt > drd2_exons.txt

grep 113414375 drd2_exons.txt > drd2_exon6.txt
grep 113413864 drd2_exons.txt > drd2_exon6_intronRetained.txt
